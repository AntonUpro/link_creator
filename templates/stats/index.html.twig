{% extends 'base.html.twig' %}

{% block title %}Статистика — QuickLink{% endblock %}

{% block body %}
    <section class="stats-hero">
        <div class="container">
            <h1><i class="fas fa-chart-bar"></i> Аналитика ссылок</h1>
            <p>Детальная статистика по вашим коротким ссылкам</p>
        </div>
    </section>

    <div class="container">
        <div class="stats-grid">
            <!-- Основные метрики -->
            <div class="metrics">
                <div class="metric-card">
                    <div class="metric-value">1,247</div>
                    <div class="metric-label">Всего кликов</div>
                    <div class="metric-change up">+12% за неделю</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">84%</div>
                    <div class="metric-label">Уникальные посетители</div>
                    <div class="metric-change up">+5%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">2.4</div>
                    <div class="metric-label">Кликов в день</div>
                    <div class="metric-change down">-3%</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">00:01:34</div>
                    <div class="metric-label">Среднее время</div>
                </div>
            </div>

            <!-- График -->
            <div class="chart-card">
                <h3><i class="fas fa-chart-line"></i> Клики за последние 30 дней</h3>
                <div class="chart-placeholder">
                    <!-- Здесь будет график (Chart.js и т.п.) -->
                    <canvas id="clicksChart"></canvas>
                </div>
            </div>

            <!-- Последние ссылки -->
            <div class="recent-links">
                <h3><i class="fas fa-history"></i> Последние ссылки</h3>
                <div class="links-list">
                    {% for link in links %}
                        <div class="link-item">
                            <div class="link-info">
                                <div class="link-url">
                                    <strong>{{ link.shortCode }}</strong>
                                    <small>{{ link.originalUrl|truncate(40) }}</small>
                                </div>
                                <div class="link-stats">
                                    <span><i class="fas fa-mouse-pointer"></i> {{ link.clicks }}</span>
                                    <span><i class="fas fa-calendar"></i> {{ link.createdAt|date('d.m.Y') }}</span>
                                </div>
                            </div>
                            <div class="link-actions">
                                <button class="btn-icon copy-btn" data-clipboard-text="{{ link.fullUrl }}">
                                    <i class="far fa-copy"></i>
                                </button>
                                <a href="{{ path('link_stats_detail', {code: link.shortCode}) }}" class="btn-icon">
                                    <i class="fas fa-chart-bar"></i>
                                </a>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <!-- География -->
            <div class="geo-card">
                <h3><i class="fas fa-globe-europe"></i>География кликов</h3>
                <div class="countries">
                    <div class="country">
                        <span>Россия</span>
                        <div class="country-bar">
                            <div class="bar-fill" style="width: 65%"></div>
                        </div>
                        <strong>65%</strong>
                    </div>
                    <div class="country">
                        <span>Украина</span>
                        <div class="country-bar">
                            <div class="bar-fill" style="width: 15%"></div>
                        </div>
                        <strong>15%</strong>
                    </div>
                    <!-- Другие страны -->
                </div>
            </div>
        </div>
    </div>
{% endblock %}
